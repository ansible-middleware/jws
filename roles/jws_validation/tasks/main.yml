---
- name: "Verify user exists."
  ansible.builtin.include_tasks: user.yml
  when:
    - jws_user is defined
    - jws_uid is defined

- name: "Verify group exists."
  ansible.builtin.include_tasks: group.yml
  when:
    - jws_group is defined
    - jws_gid is defined

- name: "Verify taht service is running."
  ansible.builtin.include_tasks: service_status.yml
  when:
    - jws_service_name is defined

- name: "Verify that main server's logfile exists."
  ansible.builtin.include_tasks: catalina_out.yml
  when:
    - catalina_logfile is defined

- name: "Ensure Tomcat HTTP connector is started and listen to the appropriate port"
  ansible.builtin.include_tasks: check_connector_port.yml
  vars:
    bind_address: "{{ jws_listen_http_bind_address }}"
    listen_port: "{{ jws_listen_http_port }}"
  when:
    - jws_listen_http_bind_address is defined
    - jws_listen_http_port is defined

- name: "Ensure Tomcat HTTPS connector is started and listen to the appropriate port"
  ansible.builtin.include_tasks: check_connector_port.yml
  vars:
    bind_address: "{{ jws_listen_https_bind_address }}"
    listen_port: "{{ jws_listen_https_port }}"
  when:
    - jws_listen_https_enabled is defined
    - jws_listen_https_bind_address is defined
    - jws_listen_https_port is defined

- name: "Ensure Tomcat AJP connector is started and listen to the appropriate port"
  ansible.builtin.include_tasks: check_connector_port.yml
  vars:
    bind_address: "{{  jws_listen_ajp_bind_address }}"
    listen_port: "{{  jws_listen_ajp_port }}"
  when:
    - jws_listen_ajp_enabled is defined
    - jws_listen_ajp_bind_address is defined
    - jws_listen_ajp_port is defined
